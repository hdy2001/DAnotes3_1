## 常微分方程数值解

### 第一节 引言

- 基本思路：
  1. 数值积分法
  2. 数值微分法

### 第二节 欧拉法

一、欧拉方法
$$
\left\{\begin{aligned}
y^{\prime} &=f(x, y) \\
y\left(x_{0}\right) &=y_{0}
\end{aligned}\right.
$$
​		用向前差商公式近似导数:
$$
\begin{aligned}
y^{\prime}\left(x_{n}\right) & \approx \frac{y\left(x_{n+1}\right)-y\left(x_{n}\right)}{h} \\
\Rightarrow y_{n+1} &=y_{n}+h f\left(x_{n}, y_{n}\right)
\end{aligned}
$$
​		依次求 $y_{1}, y_{2}, \cdots$

​																<img src="数值第九周.assets/image-20211111103141591.png" alt="image-20211111103141591" style="zoom: 33%;" />

​		误差分析：

​		局部截断误差，即假设 $y_{n}=y\left(x_{n}\right)$ 时的 $y\left(x_{n+1}\right)-y_{n+1}$

​		Taylor展开：
$$
\begin{aligned}
&y\left(x_{n+1}\right)=y\left(x_{n}\right)+h y^{\prime}\left(x_{n}\right)+\frac{h^{2}}{2} y^{(2)}\left(x_{n}\right)+\cdots \\
&y\left(x_{n+1}\right)-y_{n+1} \approx \frac{h^{2}}{2} y^{(2)}\left(x_{n}\right)=O\left(h^{2}\right)
\end{aligned}
$$
​		**一阶精度**		

​		当**分析累积误差**时, 可近似有：
$$
\begin{aligned}
\Delta_{n+1} & \approx \Delta_{n}+h \frac{\partial f}{\partial y} \Delta_{n}+\frac{h^{2}}{2} y^{(2)}\left(x_{n}\right)\\
& \approx \Delta_{n}+\frac{h^{2}}{2} y^{(2)}\left(x_{n}\right) \\
&=\frac{h^{2}}{2} \sum_{i} y^{(2)}\left(x_{i}\right) \\
& \approx \frac{h}{2}\left[y^{\prime}\left(x_{n+1}\right)-y^{\prime}\left(x_{0}\right)\right]
\end{aligned}
$$
​		考虑方法误差、存储/舍入误差[^1 ]： $\exists \xi_{n}, \zeta_{n}$
$$
\Delta_{n+1}=\Delta_{n} \underbrace{\left[1+h \cdot \frac{\partial f}{\partial y}\left(x_{n}, \xi_{n}\right)\right]}_{\Delta_{n} \text { 对下一步的影响 }}+\underbrace{\frac{h^{2}}{2} y^{(2)}\left(\zeta_{n}\right)}_{\text {局部截断误差 }}
$$
​		若 $\left|\frac{\partial f}{\partial y}(x, y)\right| \leq M,\left|y^{(2)}(x)\right| \leq L$ 则有 $\Delta_{n+1} \leq(1+h M) \Delta_{n}+\frac{h^{2}}{2} L$

​		可有
$$
\begin{array}{r}\Delta_{n+1}+\frac{1}{h M} \cdot \frac{L h^{2}}{2} \leq(1+h M)\left[\Delta_{n}+\frac{1}{h M} \cdot \frac{L h^{2}}{2}\right] \\ \leq \cdots \leq\underbrace{(1+h M)^{n+1}}_{常数，由极限得}\left[\Delta_{0}+\frac{1}{h M} \cdot \frac{L h^{2}}{2}\right]\end{array}
$$
二、后退的欧拉公式

​		用向后差商来近似导数 $y^{\prime}\left(x_{n+1}\right) \approx \frac{y\left(x_{n+1}\right)-y\left(x_{n}\right)}{h}$

​		隐性公式: 要借助其他方法得到 $y_{n+1}^{(0)}$[^3 ]
$$
\begin{aligned}
y_{n+1}^{(k+1)} &=y_{n}+h f\left(x_{n+1}, y_{n+1}^{(k)}\right), k=0,1, \cdots \\
y_{n+1} &=\lim _{k \rightarrow \infty} y_{n+1}^{(k)}
\end{aligned}
$$
​		迭代公式数值稳定性好，因$\Delta^{(k+1)}=h \frac{\partial f}{\partial y} \Delta^{(\mathrm{k})}$，其中$h \frac{\partial f}{\partial y}$ 较小就可以得到收敛。

​		局部截断误差：
$$
\begin{aligned}
&y_{n}=y\left(x_{n}\right) \\
&\quad=y\left(x_{n+1}\right)-h y^{\prime}\left(x_{n+1}\right)+\frac{h^{2}}{2} y^{(2)}\left(x_{n+1}\right)+\cdots \\
&y\left(x_{n+1}\right)-y_{n+1} \approx-\frac{h^{2}}{2} y^{(2)}\left(x_{n+1}\right)
\end{aligned}
$$
​		**一阶精度**

三、欧拉两步公式

​		用中间差商近似导数：
$$
\begin{aligned}
y^{\prime}\left(x_{n}\right) &=\frac{y\left(x_{n+1}\right)-y\left(x_{n-1}\right)}{2 h} \\
\Rightarrow y_{n+1} &=y_{n-1}+2 h f\left(x_{n}, y_{n}\right)
\end{aligned}
$$
​		用其它方法 (如欧拉法) 得到 $y_{1}$, 然后用 $y_{0}, y_{1}$ 计算 $y_{2}$, 再 $y_{3}, y_{4}, \cdots$

​		局部截断误差：
$$
\begin{aligned}
\text { 设 } y_{n-1} &=y\left(x_{n-1}\right), y_{n}=y\left(x_{n}\right) \\
y_{n-1} &=y_{n}-h y^{\prime}\left(x_{n}\right)+\frac{h^{2}}{2} y^{(2)}\left(x_{n}\right)-\frac{h^{3}}{3 !} y^{(3)}\left(x_{n}\right)+\cdots \\
y\left(x_{n+1}\right) &=y_{n}+h y^{\prime}\left(x_{n}\right)+\frac{h^{2}}{2} y^{(2)}\left(x_{n}\right)+\frac{h^{3}}{3 !} y^{(3)}\left(x_{n}\right)+\cdots \\
y_{n+1} &=y_{n-1}+2 h y^{\prime}\left(x_{n}\right) \\
\Rightarrow y\left(x_{n+1}\right)-y_{n+1} & \approx \frac{h^{3}}{3} y^{(3)}\left(x_{n}\right)=O\left(h^{3}\right)
\end{aligned}
$$
​		**二阶精度**		

​		累积误差：
$$
\begin{aligned}
\Delta_{n+1} & \approx \Delta_{n-1}+2 h \frac{\partial f}{\partial y}\left(x_{n}, y_{n}\right) \Delta_{n}+\frac{h^{3}}{3} y^{(3)}\left(x_{n}\right) \\
& \approx \Delta_{n-3}+2 h \frac{\partial f}{\partial y}\left(x_{n-2}, y_{n-2}\right) \Delta_{n-2} \\
&+2 h \frac{\partial f}{\partial y}\left(x_{n}, y_{n}\right) \Delta_{n-2}+\frac{h^{3}}{3}\left[y^{(3)}\left(x_{n}\right)+y^{(3)}\left(x_{n-2}\right)\right] \\
& \approx \cdots \approx \begin{cases}0+C_{1} \Delta_{1}+C_{2} h^{2} & \mathrm{n} \text { 为奇 } \\
\Delta_{1}+C_{2} h^{2} & \mathrm{n} \text { 为偶 }\end{cases}
\end{aligned}
$$
四、改进的欧拉法

1. 梯形公式：积分法
   $$
   \begin{aligned}
   &y\left(x_{n+1}\right)-y\left(x_{n}\right)=\int_{x_{n}}^{x_{n+1}} y^{\prime}(x) d x=\int_{x_{n}}^{x_{n+1}} f(x, y) d x \\
   &\approx \frac{h}{2}\left[f\left(x_{n}, y\left(x_{n}\right)\right)+f\left(x_{n+1}, y\left(x_{n+1}\right)\right)\right] \\
   &\begin{aligned}
   \Rightarrow y_{n+1} &=y_{n}+\frac{h}{2}\left[f\left(x_{n}, y_{n}\right)+f\left(x_{n+1}, y_{n+1}\right)\right] \\
   &=\frac{\text { 欧拉公式 }+\text { 后退欧拉公式 }}{2}
   \end{aligned}
   \end{aligned}
   $$

​		改进欧拉精度更高

2. 

## 补充

[^1 ]:$\Delta_0$​通常为0
[^2 ]:  二阶导为$f^{\prime}(x,y)$
[^3 ]: 括号里的数字是计算时迭代的轮数
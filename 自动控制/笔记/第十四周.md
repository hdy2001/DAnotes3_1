- 例子1（**不会考**，考试会给定极点）                                                     

  <img src="第十四周.assets/image-20211214100602725.png" alt="image-20211214100602725" style="zoom:50%;" />

​                                               <img src="第十四周.assets/image-20211214100639374.png" alt="image-20211214100639374" style="zoom:50%;" /> 

<img src="第十四周.assets/image-20211214101146084.png" alt="image-20211214101146084" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214101214507.png" alt="image-20211214101214507" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214101249476.png" alt="image-20211214101249476" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214101515137.png" alt="image-20211214101515137" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214101759044.png" alt="image-20211214101759044" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214101820158.png" alt="image-20211214101820158" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214101846482.png" alt="image-20211214101846482" style="zoom:50%;" />

- 例子2（待定系数法）

<img src="第十四周.assets/image-20211214102246848.png" alt="image-20211214102246848" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214102425697.png" alt="image-20211214102425697" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214102612003.png" alt="image-20211214102612003" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214103208861.png" alt="image-20211214103208861" style="zoom:50%;" />

- 总结

  由极点配置定理可知，系统完全能控是闭环极点任意配置的条件。换言之，系统完全能控, 则可以任意配置全部 $n$ 个闭环极点。并且, 对于单变量系统，实现极点配置的状态反馈阵 $\boldsymbol{k}^{\mathrm{T}}$ 是唯一的。当不满足条件时, 显然不能任意配置闭环极点, 但是, 有可能配置一些特 定的极点组。

  **问：若系统不完全能控, 能否实现极点任意配置?**
  系统不完全能控，则不能任意配置全部 $n$ 个闭环极点：
  若系统能控子系统的维数为 $r(r<n)$, 则只能任意配置可控的 $r$ 个极点; 当 其余 $(n-r)$ 个不能控的极点恰好出现在所期望的极点组中，则可以配置该特定的 极点组。
  由于状态反馈无法改变系统的不能控模态，当系统不完全能控时，若希望的极点组中包含了系统所有不能控模态时, 这组期望极点也是可以配置的。

- 例子（不完全能控）

  <img src="第十四周.assets/image-20211214103419674.png" alt="image-20211214103419674" style="zoom:50%;" />

<img src="第十四周.assets/image-20211214104428943.png" alt="image-20211214104428943" style="zoom:50%;" />

## 镇定问题

假定线性系统 $\Sigma(\boldsymbol{A}, \boldsymbol{B}, \boldsymbol{C})$ 完全能控, 则一定存在线性状态反馈 $\boldsymbol{K}$, 使闭环系 统 $\Sigma_{K}(\boldsymbol{A}-\boldsymbol{B} \boldsymbol{K}, \boldsymbol{B}, \boldsymbol{C})$ 极点可任意配置。换言之, 对完全能控的不稳定系统, 总可以求得线性状态反馈阵 $K$, 使系统变为渐近稳定, 即 $A-B K$ 的特征值均在 $s$ 平面的左边。这就是镇定问题。
可见，**镇定问题是极点配置问题的一个特例。**
在镇定问题中, 只要求极点配置在 $s$ 平面的左边, 而不必在具体某个位置上。 所以对系统 $\Sigma(\boldsymbol{A}, \boldsymbol{B}, \boldsymbol{C})$, 若存在状态反馈阵 $\boldsymbol{K}$, 使闭环系统 $\Sigma_{K}(\boldsymbol{A}-\boldsymbol{B} \boldsymbol{K}, \boldsymbol{B}, \boldsymbol{C})$ 的极点都具有负实部，则称原系统是状态反馈可镇定的。

1. 状态反馈可镇定的条件

   线性系统状态反馈可镇定的充分必要条件为：**系统不能控的部分是渐近稳定的。 **

   对此说明如下: 假定系统已按能控性分解为如下形式:
   $$
   \boldsymbol{A}=\left[\begin{array}{cc}
   \boldsymbol{A}_{11} & \boldsymbol{A}_{12} \\
   \mathbf{0} & \boldsymbol{A}_{22}
   \end{array}\right], \boldsymbol{B}=\left[\begin{array}{c}
   \boldsymbol{B}_{1} \\
   \mathbf{0}
   \end{array}\right] \text {, 设状态反馈阵为 } \boldsymbol{K}=\left[\begin{array}{ll}
   \boldsymbol{K}_{1} & \boldsymbol{K}_{2}
   \end{array}\right] \text {, 则 }
   $$
   闭环系统的状态矩阵为: $\boldsymbol{A}-\boldsymbol{B} \boldsymbol{K}=\left[\begin{array}{cc}\boldsymbol{A}_{11}-\boldsymbol{B}_{1} \boldsymbol{K}_{1} & \boldsymbol{A}_{12}-\boldsymbol{B}_{1} \boldsymbol{K}_{2} \\ 0 & \boldsymbol{A}_{22}\end{array}\right]$
   其特征多项式为: $f_{K}(s)=|s \boldsymbol{I}-(\boldsymbol{A}-\boldsymbol{B} \boldsymbol{K})|=\left|s \boldsymbol{I}_{1}-\boldsymbol{A}_{11}+\boldsymbol{B}_{1} \boldsymbol{K}_{1}\right| \cdot\left|s \boldsymbol{I}_{2}-\boldsymbol{A}_{22}\right|$

   显然, $\Sigma_{1}\left(A_{11}, B_{1}\right)$ 是能控部分, 所以上式中的 $\left|s I_{1}-A_{11}+B_{1} K_{1}\right|$ 部分可以通过极点配置的方法使 $A_{11}+B_{1} K_{1}$ 的极点具有负实部, 而 $\Sigma_{2}\left(A_{22}, 0\right)$ 是不能控部分，上式中的行列式 $\left|s I_{2}-A_{22}\right|$ 说明无 法通过极点配置方法改变 $A_{22}$ 的极点, 而必须要求 $A_{22}$ 的极点 具有负实部。结论得证。

   - 例子

     <img src="第十四周.assets/image-20211214105010290.png" alt="image-20211214105010290" style="zoom:50%;" />

     <img src="第十四周.assets/image-20211214105107225.png" alt="image-20211214105107225" style="zoom:50%;" />

2. 输出反馈能镇定的条件

   对于输出反馈, 我们知道它保持了系统的能控性和能观性, 即输出反馈不能 改变系统的不能控模态和不能观模态。
   假定已经将系统 $\Sigma(\boldsymbol{A}, \boldsymbol{B}, \boldsymbol{C})$ 进行 Kalman 结构分解:
   $$
   A=\left[\begin{array}{cccc}
   A_{11} & 0 & A_{13} & 0 \\
   A_{21} & A_{22} & A_{23} & A_{24} \\
   0 & 0 & A_{33} & 0 \\
   0 & 0 & A_{43} & A_{44}
   \end{array}\right], B=\left[\begin{array}{c}
   B_{1} \\
   B_{2} \\
   0 \\
   0
   \end{array}\right], C=\left[\begin{array}{llll}
   C_{1} & 0 & C_{3} & 0
   \end{array}\right]
   $$
   其中 $\left(A_{1}, B_{1}, C_{1}\right)$ 是能控且能观的; $\left(A_{22}, B_{2}, 0\right)$ 是能控不能观的;
   $\left(A_{33}, 0, C_{3}\right)$ 是不能控而能观的; $\left(A_{4}, 0,0\right)$ 是不能控又不能观的。
   则对于这样的系统输出反馈镇定的充分必要条件为: **1） 能控又能观部分是能 镇定的；2）其它的三部分均是渐近稳定的。**

   对此说明如下: 设输出反馈阵为 $H$, 则闭环系统矩阵为:
   $$
   A-B H C=\left[\begin{array}{cccc}
   A_{11}-B_{1} H C_{1} & 0 & A_{13}-B_{1} H C_{3} & 0 \\
   A_{21}-B_{2} H C_{1} & A_{22} & A_{23}-B_{2} H C_{3} & A_{24} \\
   0 & 0 & A_{33} & 0 \\
   0 & 0 & A_{43} & A_{44}
   \end{array}\right]
   $$
   其特征多项式为:
   $$
   \begin{aligned}
   f_{H}(s) &=|s \boldsymbol{I}-(\boldsymbol{A}-\boldsymbol{B H C})| \\
   &=\left|s \boldsymbol{I}_{1}-\left(\boldsymbol{A}_{11}-\boldsymbol{B}_{1} \boldsymbol{H C}_{1}\right)\right| \cdot\left|s \boldsymbol{I}_{2}-\boldsymbol{A}_{22}\right| \cdot\left|s \boldsymbol{I}_{3}-\boldsymbol{A}_{33}\right| \cdot\left|s \boldsymbol{I}_{4}-\boldsymbol{A}_{44}\right|
   \end{aligned}
   $$
   可以看出，当且仅当 $A_{11}-B_{1} H C_{1}$ 具有负实部的极点，即能控又能观部分为输出 反馈能镇定, $A_{22}, A_{33}, A_{44}$ 均具有负实部的极点。即其余三部分为渐近稳定的时 候，闭环系统才是渐近稳定的。
   这说明了结论的正确性。

# 模块五 状态观测器

## 状态观测器的基本概念

本章讨论这个问题，原系统的输入输出可以直接量测。以原系统的输入输出作为输入，再构造一个动态系统，将状态重新构造出来，这样的动态系统称为状态观测器

- 开环状态观测器[^1 ]
- 全维观测器[^2 ]

## 全维观测器

- 观测误差的演化规律
$$
\dot{\tilde{x}}=(A+M C) \tilde{x}
$$
​		全维观测器的设计，实际上在于合理选择 $M$ 阵，使 $(A+M C)$ 的特征 值具有负实部，而且负实部的绝对值足够大，使逼近的速度足够快。 在选择合理的观测器极点后, 就可以计算 $M$ 。

- 方法一

  以单变量系统为例设计步骤如下:
  (1) 判别系统的能观性;
  (2) 若系统能观, 化为能观标准型;

  能观标准型[^3 ]为 $\tilde{\Sigma}\left(\tilde{A}, \tilde{c}^{T}\right)$, 其中
  $$
  \tilde{\boldsymbol{A}}=\left[\begin{array}{c:c}
  0 & -P_{n} \\
  \hdashline & -P_{n-1} \\
  \boldsymbol{I}_{n-1} & \vdots \\
  & -P_{1}
  \end{array}\right] \quad \tilde{\boldsymbol{c}}^{\mathrm{T}}=\left[\begin{array}{llll}
  0 & \cdots & 0 & 1
  \end{array}\right]
  $$
  $\tilde{A}$ 的特征多项式:
  $$
  f(s)=s^{n}+P_{1} s^{n-1}+\cdots+P_{n}
  $$
  (3) 计算 $\tilde{\Sigma}\left(\tilde{\boldsymbol{A}}, \tilde{\boldsymbol{c}}^{\mathrm{T}}\right)$ 能观标准型的观测阵 $\tilde{\boldsymbol{M}}=\left[\tilde{m}_{1}, \tilde{m}_{2}, \ldots, \tilde{m}_{n}\right]$, 则观测器系数矩阵为:
  $$
  \tilde{\boldsymbol{A}}+\tilde{\boldsymbol{M}} \tilde{\boldsymbol{c}}^{T}=\left[\begin{array}{c:c}
  \mathbf{0} & -P_{n} \\
  \hdashline \boldsymbol{I}_{n-1} & \vdots \\
  & -P_{1}
  \end{array}\right]+\left[\begin{array}{cccc}
  0 & \cdots & 0 & \tilde{m}_{1} \\
  0 & \cdots & 0 & \tilde{m}_{2} \\
  \vdots & & \vdots & \vdots \\
  0 & \cdots & 0 & \tilde{m}_{n}
  \end{array}\right]=\left[\begin{array}{c:c}
  \mathbf{0} & -\left(P_{n}-\tilde{m}_{1}\right) \\
  \hdashline \boldsymbol{I}_{n-1} & \vdots \\
  & -\left(P_{1}-\tilde{m}_{n}\right)
  \end{array}\right]
  $$
  于是特征多项式为: $f(s)=s^{n}+\left(P_{1}-\tilde{m}_{n}\right) s^{n-1}+\cdots+\left(P_{n-1}-\tilde{m}_{2}\right) s+\left(P_{n}-\tilde{m}_{1}\right)$ (5.9) 

  根据希望的观测器极点, 得到希望的特征多项式
  $f^{*}(s)=s^{n}+\alpha_{1}^{*} s^{n-1}+\cdots+\alpha_{n-1}^{*} s+\alpha_{n}^{*}$     （5.10）

  比较 (5.9), (5.10) 两式得: $\tilde{m}_{n+1-i}=P_{i}-\alpha_{i}^{*} \quad(i=1,2, \cdots, n)$
  (4) 求原系统 $\sum\left(\boldsymbol{A}, \boldsymbol{b}, \boldsymbol{c}^{T}\right)$ 的观测阵 $\boldsymbol{M}: \boldsymbol{M}=\boldsymbol{T} \tilde{\boldsymbol{M}}$
  (5) 画出观测器的结构图。

- 例子

  <img src="第十四周.assets/image-20211214120148106.png" alt="image-20211214120148106" style="zoom:50%;" />

  <img src="第十四周.assets/image-20211214120235762.png" alt="image-20211214120235762" style="zoom:50%;" />

  <img src="第十四周.assets/image-20211214120510337.png" alt="image-20211214120510337" style="zoom:50%;" />

  <img src="第十四周.assets/image-20211214120533702.png" alt="image-20211214120533702" style="zoom:50%;" />

- 方法二（直接计算）（待定系数法）
  (1) 判别系统的能观性;
  (2) $f_{M}(s)=\left|s \boldsymbol{I}-\left(\boldsymbol{A}+\boldsymbol{M} \boldsymbol{c}^{T}\right)\right|$
  (3) $f^{*}(s)=\prod_{i=1}^{n}\left(s-\lambda_{i}\right)$
  (4) 令二者系数相等, 联立方程求解得到。

- 例子

  <img src="第十四周.assets/image-20211214121038791.png" alt="image-20211214121038791" style="zoom:50%;" />

  <img src="第十四周.assets/image-20211214121243047.png" alt="image-20211214121243047" style="zoom:50%;" />

  <img src="第十四周.assets/image-20211214121255641.png" alt="image-20211214121255641" style="zoom:50%;" />

  <img src="第十四周.assets/image-20211214121317107.png" alt="image-20211214121317107" style="zoom:50%;" />

  <img src="第十四周.assets/image-20211214121333361.png" alt="image-20211214121333361" style="zoom:50%;" />

## 降维观测器（自学）

# 补充资料

[^1 ]: 见第五章ppt第7页
[^2 ]: 见第五章ppt第9页
[^3 ]: 状态反馈极点配置的对偶形式


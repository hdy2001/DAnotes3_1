## 多输入多输出系统的状态空间表达式

- 已知系统的状态空间表达式为;

  ![image-20211116193033119](第十周.assets/image-20211116193033119.png)

- 假设初始状态为0，对上做laplace变换得：
  $$
  \left\{\begin{array}{l}
  \boldsymbol{x}(s)=(s \boldsymbol{I}-\boldsymbol{A})^{-1} \boldsymbol{B} \boldsymbol{u}(s) \\
  \boldsymbol{y}(s)=\boldsymbol{C} \boldsymbol{x}(s)+\boldsymbol{D} \boldsymbol{u}(s)
  \end{array}\right.
  $$
  得到系统传递函数阵 $\boldsymbol{G}(s)=\boldsymbol{C}(s \boldsymbol{I}-\boldsymbol{A})^{-1} \boldsymbol{B}+\boldsymbol{D} \quad \boldsymbol{y}(s)=\boldsymbol{G}(s) \boldsymbol{u}(s)$

- 系统的传递函数$G(s)$是一个$m\times r$维的矩阵函数，可表示为：
  $$
  \boldsymbol{G}(s)=\left[\begin{array}{ccc}
  g_{11}(s) & \cdots & g_{1 r}(s) \\
  \vdots & \ddots & \vdots \\
  g_{m 1}(s) & \cdots & g_{m r}(s)
  \end{array}\right]
  $$
   $g_{i j}(s)$ 都是标量函数, 在物理上表示为第 $j$ 个输入对第 $i$ 个输出的传递关系。当 $i \neq j$ 时, 意味着不同标号的输入与输出有相互关联, 称为耦合关系。

- 多变量函数**例子**：

  考虑如下系统, 其状态方程和输出方程分别为:
  $$
  \left[\begin{array}{l}
  \dot{x}_{1} \\
  \dot{x}_{2}
  \end{array}\right]=\left[\begin{array}{cc}
  0 & 1 \\
  -2 & -3
  \end{array}\right]\left[\begin{array}{l}
  x_{1} \\
  x_{2}
  \end{array}\right]+\left[\begin{array}{ll}
  1 & 0 \\
  1 & 1
  \end{array}\right]\left[\begin{array}{l}
  u_{1} \\
  u_{2}
  \end{array}\right],\left[\begin{array}{l}
  y_{1} \\
  y_{2} \\
  y_{3}
  \end{array}\right]=\left[\begin{array}{ll}
  1 & 0 \\
  1 & 1 \\
  0 & 2
  \end{array}\right]\left[\begin{array}{l}
  x_{1} \\
  x_{2}
  \end{array}\right]+\left[\begin{array}{ll}
  0 & 0 \\
  1 & 0 \\
  0 & 1
  \end{array}\right]\left[\begin{array}{l}
  u_{1} \\
  u_{2}
  \end{array}\right]
  $$
  求系统的传递函数矩阵。

  <img src="第十周.assets/image-20211116193701020.png" alt="image-20211116193701020" style="zoom: 50%;" />

  <img src="第十周.assets/image-20211116193722093.png" alt="image-20211116193722093" style="zoom:50%;" />

  

## 组合系统的空间表达式及传递函数阵

- 实际控制系统由多个子系统组合而成，串联、并联、或反馈连接，这种系统成为**组合系统**。

- **并联组合系统**：

  ![image-20211116194021418](第十周.assets/image-20211116194021418.png)

  $\boldsymbol{u}_{1}=\boldsymbol{u}_{2}=\boldsymbol{u}, \boldsymbol{y}=\boldsymbol{y}_{1}+\boldsymbol{y}_{2}$

  并联子系统的状态空间表达式:
  $$
  \left\{\begin{array}{l}
  {\left[\begin{array}{l}
  \dot{x}_{1} \\
  \dot{x}_{2}
  \end{array}\right]=\left[\begin{array}{cc}
  A_{1} & 0 \\
  0 & A_{2}
  \end{array}\right]\left[\begin{array}{l}
  x_{1} \\
  x_{2}
  \end{array}\right]+\left[\begin{array}{l}
  B_{1} \\
  B_{2}
  \end{array}\right] u} \\
  y=\left[\begin{array}{ll}
  C_{1} & C_{2}
  \end{array}\right]\left[\begin{array}{l}
  x_{1} \\
  x_{2}
  \end{array}\right]+\left(D_{1}+D_{2}\right) u
  \end{array}\right.
  $$
  从而组合系统的传递函数阵为:
  $$
  \begin{aligned}
  \boldsymbol{G}(s) &=\left[\begin{array}{ll}
  \boldsymbol{C}_{1} & \boldsymbol{C}_{2}
  \end{array}\right]\left[\begin{array}{cc}
  \left(s \boldsymbol{I}-\boldsymbol{A}_{1}\right)^{-1} & \boldsymbol{0} \\
  \mathbf{0} & \left(s \boldsymbol{I}-\boldsymbol{A}_{2}\right)^{-1}
  \end{array}\right]\left[\begin{array}{l}
  \boldsymbol{B}_{1} \\
  \boldsymbol{B}_{2}
  \end{array}\right]+\left(\boldsymbol{D}_{1}+\boldsymbol{D}_{2}\right) \\
  &=
  [\boldsymbol{C}_{1}\left(s \boldsymbol{I}-\boldsymbol{A}_{1}\right)^{-1} \boldsymbol{B}_{1}+\boldsymbol{D}_{1}]+ [\boldsymbol{C}_{2}\left(s \boldsymbol{I}-\boldsymbol{A}_{2}\right)^{-1} \boldsymbol{B}_{2}+\boldsymbol{D}_{2}] \\
  & =\boldsymbol{G}_{1}(s)+\boldsymbol{G}_{2}(s)
  \end{aligned}
  $$
  因此, **系统并联时, 系统传递函数阵等于子系统的传递函数阵之和。**

- **串联组合系统**

  ![image-20211116194441985](第十周.assets/image-20211116194441985.png)

  $\boldsymbol{u}=\boldsymbol{u}_{1}, \boldsymbol{y}_{1}=\boldsymbol{u}_{2}, \boldsymbol{y}=\boldsymbol{y}_{2}$
  $$
  G(s) = G_2(s)\cdot G_1(s)
  $$
  因此, **系统串联时, 系统传递函数阵等于子系统的传递函数阵之积**[^1]，注意，子系统的先后顺序不能颠倒。

- **具有输出反馈的系统**

  ![image-20211116195129306](第十周.assets/image-20211116195129306.png)

  系统开环传递函数矩阵为 $\boldsymbol{G}_{o}(s)=\boldsymbol{C}(s \boldsymbol{I}-\boldsymbol{A})^{-1} \boldsymbol{B}$ 

  闭环系统状态空间表达式: $\left\{\begin{array}{l}\dot{x}=A x+B(u-H y)=(A-B H C) x+B u \\ y=C x\end{array}\right.$ 故

  常数反馈系统传递函数阵为: $\boldsymbol{G}(s)=\boldsymbol{C}(s \boldsymbol{I}-\boldsymbol{A}+\boldsymbol{B} \boldsymbol{H} \boldsymbol{C})^{-1} \boldsymbol{B}$

  且开环传递函数和闭环传递函数关系[^2]为：$\boldsymbol{G}(s)=\left[\boldsymbol{I}+\boldsymbol{G}_{o}(s) \boldsymbol{H}\right]^{-1} \boldsymbol{G}_{o}(s)$

  同理, $\boldsymbol{G}(s)=\boldsymbol{G}_{o}(s)\left[\boldsymbol{I}+\boldsymbol{H} \boldsymbol{G}_{o}(s)\right]^{-1}$

- **动力反馈系统**

  <img src="第十周.assets/image-20211116195719535.png" alt="image-20211116195719535" style="zoom:50%;" />

  动态反馈系统的子系统状态方程:
  $$
  \Sigma_{1}:\left\{\begin{array}{l}
  \dot{x}_{1}=A_{1} x_{1}+B_{1} u_{1} \\
  y_{1}=C_{1} x_{1}
  \end{array} \quad \Sigma_{2}:\left\{\begin{array}{l}
  \dot{x}_{2}=A_{2} x_{2}+B_{2} u_{2} \\
  y_{2}=C_{2} x_{2}
  \end{array}\right.\right.\\
  \boldsymbol{u}_{1}=\boldsymbol{u}-\boldsymbol{y}_{2}, \boldsymbol{y}=\boldsymbol{y}_{1}=\boldsymbol{u}_{2}
  $$
  由此可得动态反馈系统的状态空间表达式为: $\left\{\begin{array}{l}\dot{x}_{1}=A_{1} x_{1}+B_{1} u-B_{1} C_{2} x_{2} \\ \dot{x}_{2}=A_{2} x_{2}+B_{2} C_{1} x_{1} \\ y=C_{1} x_{1}\end{array}\right.$
  写成矩阵形式: $\left[\begin{array}{c}\dot{x}_{1} \\ \dot{x}_{2}\end{array}\right]=\left[\begin{array}{cc}A_{1} & -B_{1} C_{2} \\ B_{2} C_{1} & A_{2}\end{array}\right]\left[\begin{array}{c}x_{1} \\ x_{2}\end{array}\right]+\left[\begin{array}{c}B_{1} \\ 0\end{array}\right] u$
  $$
  \boldsymbol{y}=\left[\begin{array}{ll}
  \boldsymbol{C}_{1} & \mathbf{0}
  \end{array}\right]\left[\begin{array}{l}
  \boldsymbol{x}_{1} \\
  \boldsymbol{x}_{2}
  \end{array}\right]
  $$
  可得[^3 ]: $\boldsymbol{G}(s)=\left[\boldsymbol{I}+\boldsymbol{G}_{1}(s) \boldsymbol{G}_{2}(s)\right]^{-1} \boldsymbol{G}_{1}(s)$
  同理, $\boldsymbol{G}(s)=\boldsymbol{G}_{1}(s)\left[\boldsymbol{I}+\boldsymbol{G}_{2}(s) \boldsymbol{G}_{1}(s)\right]^{-1}$

## 系统的时域描述及状态空间表达式

- 对于一个单输入单输出线性定常系统, 在经典控制理论中通常由 一个 $n$ 阶线性常系数微分方程来描述:

$$
\begin{aligned}
&y^{(n)}+a_{1} y^{(n-1)}+\cdots+a_{n-1} \dot{y}+a_{n} y \\
&=b_{0} u^{(m)}+b_{1} u^{(m-1)}+\cdots+b_{m-1} \dot{u}+b_{m} u
\end{aligned}
$$

- 单输入单输出线性定常系统的状态空间表达式:

$$
\left\{\begin{array}{l}
\dot{x}=A x+b u \\
y=c^{\mathrm{T}} x+d u
\end{array}\right.
$$

- 高阶微分方程中含有作用函数导数项：

  例: 三阶系统 $y^{(3)}+a_{1} y^{(2)}+a_{2} \dot{y}+a_{3} y=b_{1} u^{(2)}+b_{2} \dot{u}+b_{3} u$

- 推广至一般的 $n$ 阶系统:
$$
\begin{gathered}
y^{(n)}+a_{1} y^{(n-1)}+\cdots+a_{n-1} \dot{y}+a_{n} y \\
=b_{0} u^{(n)}+b_{1} u^{(n-1)}+\cdots+b_{n-1} \dot{u}+b_{n} u
\end{gathered}
$$
得到:

<img src="第十周.assets/image-20211116201543612.png" alt="image-20211116201543612" style="zoom:50%;" />

- 该形式的状态空间表达式称为能控标准I型, 也称控制器规范型（或第二可控规范型）。

- 例子：

  <img src="第十周.assets/image-20211116201739981.png" alt="image-20211116201739981" style="zoom:50%;" />

- 小结：

  <img src="第十周.assets/image-20211116201834674.png" alt="image-20211116201834674" style="zoom:50%;" />

<img src="第十周.assets/image-20211116202031075.png" alt="image-20211116202031075" style="zoom:50%;" />

<img src="第十周.assets/image-20211116202017026.png" alt="image-20211116202017026" style="zoom:50%;" />

## 基于模拟结构图写出状态空间表达式

### 基于串并联分解

- 当系统的描述是以方块图给出时, 基于各模块的串并联分解可 直接导出相应的状态空间表达式

- 模拟图的基本单元实现：

  <img src="第十周.assets/image-20211116202609882.png" alt="image-20211116202609882" style="zoom:50%;" />

- 例一：

<img src="第十周.assets/image-20211116202435072.png" alt="image-20211116202435072" style="zoom:50%;" />

<img src="第十周.assets/image-20211116202451739.png" alt="image-20211116202451739" style="zoom:50%;" />

- 例二：

  <img src="第十周.assets/image-20211116202716194.png" alt="image-20211116202716194" style="zoom:50%;" />

### 基于部分分式分解

- 将传递函数展开成部分分式, 根据此部分分式画出其模拟结构图, 然后由此模拟结构图写出的状态空间表达式是具有一定特点的约当标准型。
- 设单输入一单输出系统的传递函数如下:
$$
g(s)=\frac{b_{0} s^{n}+b_{1} s^{n-1}+\cdots+b_{n-1} s+b_{n}}{s^{n}+a_{1} s^{n-1}+\cdots+a_{n-1} s+a_{n}}
$$
- 分两种情况进行讨论
  - 情形 (1): 所有的特征值都是两两相异的
  - 情形 (2): 存在部分特征值是相同的

- （1）设传递函数具有两两相异的特征值 $\lambda_{1}, \lambda_{2}, \cdots, \lambda_{n}$, 则 $g(s)$ 可 展开为如下部分分式
$$
g(s)=\frac{y(s)}{u(s)}=\frac{\alpha_{1}}{s-\lambda_{1}}+\frac{\alpha_{2}}{s-\lambda_{2}}+\cdots+\frac{\alpha_{n}}{s-\lambda_{n}}+\delta
$$
- 其中:

$$
\begin{aligned}
\alpha_{i} &=\lim _{s \rightarrow \lambda_{1}}\left(s-\lambda_{i}\right) \cdot g(s) \quad i=1,2, \cdots, n \\
y(s) &=\sum_{i=1}^{n} \frac{\alpha_{i}}{s-\lambda_{i}} u(s)+\delta u(s) \quad i=1,2, \cdots, n
\end{aligned}
$$

<img src="第十周.assets/image-20211116203022824.png" alt="image-20211116203022824" style="zoom:50%;" />

- 这种结构的显著特点是积分器不再是前后串联形式而是并联形式。

- 取上图中的状态变量, 则状态方程和输出方程可表示为:

  ![image-20211116203354942](第十周.assets/image-20211116203354942.png)

- 两式互为对偶, 两式的系数矩阵 $A$ 均为对角矩阵, 对角线上各元素 是互异的 $n$ 个特征值, 故称为**对角线标准型**或**解耦标准型**, 即变量 之间不存在耦合关系。一般地, 它属于如下的**约当标准型**:

$$
g(s)=\frac{b_{0} s^{n}+b_{1} s^{n-1}+\cdots+b_{n-1} s+b_{n}}{s^{n}+a_{1} s^{n-1}+\cdots+a_{n-1} s+a_{n}}
$$

## 补充

[^1 ]: 具体推导参见第十周课件第30页
[^2 ]: 具体推导参见第十周课件第37页
[^3 ]: 具体推导参见第十周课件第40页